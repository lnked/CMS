"use strict";var shopping=function(c){function n(){var e=location.search.substr(1),a={};return e.split("&").forEach(function(e){var t=e.split("=");a[t[0]]=encodeURI(unescape(unescape(t[1])))}),a}function o(e,t){var a=n();return a[e]=t,a}function l(t){var a=[];return Object.keys(t).map(function(e){"undefined"!==t[e]&&""!==t[e]&&a.push([e,t[e]].join("="))}),a.join("&")}function i(t){if(Object.keys(t).length){var a="",n=["page","backuri"];Object.keys(t).map(function(e){n.indexOf(e)<0&&"undefined"!==t[e]&&""!==t[e]&&(""!==a&&(a+="&"),a+=[e,t[e]].join("="))}),location.href="/"+ADMIN_DIR+"/shopping/catalog?"+a}}return{tab:function(e,t){c(".tabs__list__link").removeClass("tabs__list__link_current"),c(".catalog-tabs__item").removeClass("current"),c(e).addClass("tabs__list__link_current"),c("#tab-"+t).addClass("current")},sort:function(e){var t=n();if(void 0!==t.sort){var a=t.sort.split("-")[1];a="asc"===a?"desc":"asc",location.search=l(o("sort",e+"-"+a))}else location.search=l(o("sort",e+"-asc"))},search:function(e,t,a,n){a?13==n.keyCode&&i(o(e,t)):i(o(e,t))},reload:function(){var e=n();if(void 0!==e.page){var t=0<=e.page-1?e.page-1:"";t?location.search="page="+t:location.reload()}else location.reload()},setLimit:function(e,t){var a=parseInt(t.value);if(0<a){var n=["module","pages",e].join("_");c.removeCookie(n),c.cookie(n,a,{expires:30,path:"/"}),setTimeout(function(){location.reload()},50)}},generateMeta:function(){},requestBalance:function(t,a){c.ajax({url:["/",ADMIN_DIR,"/shopping/set/balance"].join(""),type:"post",data:a,dataType:"JSON",success:function(e){t.prop("disabled",a.disabled),void 0===a.disabled||a.disabled||t.focus()}})},inputBalance:function(e){var t=c("#balance-"+e),a=t.val();this.requestBalance(t,{id:e,value:a})},changeBalance:function(e){var t=e.value,a=c("#balance-"+t),n=a.val(),o=e.checked;this.requestBalance(a,{id:t,value:n,disabled:o?1:0})},update:function(e,t,a){var n=Number(e.target.checked);c.ajax({url:["/",ADMIN_DIR,"/shopping/update"].join(""),type:"post",data:{id:a,name:t,value:n},dataType:"JSON",success:function(e){}})},checkByName:function(e){var t=c(e).val(),a=c(e).prop("checked");c('.check-all-spy[name="'+t+'"]').prop("checked",a)},checkAll:function(e){var t=c(e).prop("checked");c(".check-all-spy").prop("checked",t),t?c("#remove-button").addClass("enable"):c("#remove-button").removeClass("enable")},checkItem:function(e){c(".check-all-spy:checked").length?c("#remove-button").addClass("enable"):c("#remove-button").removeClass("enable")},deleteManufacturer:function(e,t){e.preventDefault(),cp.dialog("Вы действительно хотите удалить производителя?")&&c.ajax({url:["/",ADMIN_DIR,"/shopping/manufacturer/del/",t].join(""),type:"get",dataType:"JSON",success:function(){c("#module-table").find('.module-table__row[data-id="'+t+'"]').remove(),cp.notify("Производитель удален","info")}})},deleteProduct:function(e,t){e.preventDefault(),cp.dialog("Вы действительно хотите удалить товар?")&&this.deleteItem(t,!0)},deleteItem:function(e,t){c.ajax({url:["/",ADMIN_DIR,"/shopping/catalog/del/",e].join(""),type:"get",dataType:"JSON",success:function(){c("#module-table").find('.module-table__row[data-id="'+e+'"]').remove(),t&&cp.notify("Товар удален","info")}})},deleteAll:function(e){e.preventDefault();var a=c(".check-all-spy:checked").length,n=c(".check-all-spy").length;if(a){var o=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(a,["товар","товара","товаров"]),"?"].join(""))&&c(".check-all-spy:checked").each(function(e,t){o.deleteItem(parseInt(c(t).val()),!1),e+1==a&&(cp.notify(["Удалено ",declOfNum(a,["товар","товара","товаров"])].join(""),"info"),setTimeout(function(){a==n?o.reload():location.reload()},150))})}}}}(jQuery),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},orders=function(c){return{toggle:function(e,t,a,n){if(c("#"+t).length&&c("#"+t).toggleClass(a),"boolean"==typeof n&&!0===n&&c(e).remove(),"object"===(void 0===n?"undefined":_typeof(n))){var o=c("#"+t).hasClass(a)?0:1;c(e).text(n[o])}},deleteItem:function(e,t){c.ajax({url:["/",ADMIN_DIR,"/shopping/orders/del/",e].join(""),type:"get",dataType:"JSON",success:function(){c("#module-table").find('.module-table__row[data-id="'+e+'"]').remove(),t&&cp.notify("Товар удален","info")}})},deleteAll:function(e){e.preventDefault();var a=c(".check-all-spy:checked").length,n=c(".check-all-spy").length;if(a){var o=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(a,["заказ","заказа","заказов"]),"?"].join(""))&&c(".check-all-spy:checked").each(function(e,t){o.deleteItem(parseInt(c(t).val()),!1),e+1==a&&(cp.notify(["Удалено ",declOfNum(a,["заказ","заказа","заказов"])].join(""),"info"),setTimeout(function(){a==n?shopping.reload():location.reload()},150))})}}}}(jQuery);